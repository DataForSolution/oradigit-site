---
layout: default
title: OraDigit Order Helper
permalink: /order-helper/
description: Evidence-based PET/CT, CT, and MRI order helper with validation and export. No PHI. Educational use only.
---

<!-- Page-scoped assets & config -->
<meta name="oh-rules-path" content="{{ '/order-helper/data/rules.json' | relative_url }}?v=20250904">
<meta name="oh-version" content="20250904">
<link rel="stylesheet" href="{{ '/order-helper/style.css' | relative_url }}?v=20250904">

<!-- Error beacon: surface JS errors in the status bar -->
<script>
  window.addEventListener('error', e => {
    const s = document.getElementById('status');
    if (s) {
      s.textContent = 'JavaScript error: ' + (e.message || 'Unknown');
      s.className = 'status error';
    }
  });
</script>

<script>
  document.addEventListener('DOMContentLoaded', async () => {
    const s = document.getElementById('status');
    if (!s) return;
    const url = document.querySelector('meta[name="oh-rules-path"]')?.content;
    if (!url) {
      s.textContent = 'Missing oh-rules-path meta.';
      s.className = 'status error';
      return;
    }
    try {
      s.textContent = 'Boot check… fetching rules…';
      const r = await fetch(url, { cache: 'no-store' });
      if (r.ok) {
        s.textContent = 'Boot check OK. Loading app…';
        s.className = 'status success';
      } else {
        s.textContent = `Rules fetch failed (${r.status}). Check path/case: ` + url;
        s.className = 'status error';
      }
    } catch (e) {
      s.textContent = 'Rules fetch error: ' + e.message;
      s.className = 'status error';
    }
  });
</script>

<!-- Your section layout and UI form stays unchanged -->
<!-- ... (no modifications in the form, preview, or results blocks) -->

<!-- Firebase (Compat CDN) -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js" defer></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js" defer></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js" defer></script>

<!-- Firebase Auto-init -->
<script>
  document.addEventListener('DOMContentLoaded', () => {
    try {
      if (window.ORADIGIT_FIREBASE_CONFIG && !window.firebase?.apps?.length) {
        firebase.initializeApp(window.ORADIGIT_FIREBASE_CONFIG);
        window.OH_FIREBASE = {
          app: firebase.app(),
          auth: firebase.auth(),
          db: firebase.firestore()
        };
        const s = document.getElementById('status');
        if (s) {
          s.textContent = 'Firebase ready.';
          s.className = 'status success';
        }
      }
    } catch (e) {
      const s = document.getElementById('status');
      if (s) {
        s.textContent = 'Firebase failed to initialize. Check your config.';
        s.className = 'status warn';
      }
      console.warn('Firebase init error:', e);
    }
  });
</script>

<!-- Preview sync + indication copy -->
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const $ = (s) => document.querySelector(s);
    const form = $('#orderForm');
    const syncPreview = () => {
      const $s = (sel) => document.querySelector(sel);
      $s('#pv-modality').textContent = $s('#modality')?.value || '—';
      $s('#pv-region').textContent = $s('#region')?.value || '—';
      const ctxOpt = Array.from(document.querySelectorAll('#context option:checked')).map(o => o.value);
      $s('#pv-context').textContent = ctxOpt.length ? ctxOpt.join(', ') : '—';
      $s('#pv-condition').textContent = $s('#condition')?.value || '—';
      const grp = document.getElementById('contrastGroup');
      if (grp && !grp.classList.contains('hidden')) {
        const r = grp.querySelector('input[type=radio]:checked');
        const oral = document.getElementById('oralContrast')?.checked;
        let txt = r ? (r.value === 'with_iv' ? 'With IV contrast' : 'Without IV contrast') : '—';
        if (oral) txt += ' + oral';
        $s('#pv-contrast').textContent = txt;
      } else {
        $s('#pv-contrast').textContent = '—';
      }
      $s('#pv-indication').textContent = $s('#indication')?.value?.trim() || '—';
    };
    ['change','input','click'].forEach(evt => {
      form.addEventListener(evt, syncPreview, true);
    });
    $('#copyIndication')?.addEventListener('click', async () => {
      const text = $('#indication')?.value || '';
      if (!text.trim()) return;
      try {
        await navigator.clipboard.writeText(text.trim());
        const s = document.getElementById('status');
        if (s) {
          s.textContent = 'Clinical indication copied to clipboard.';
          s.className = 'status success';
        }
      } catch {
        const s = document.getElementById('status');
        if (s) {
          s.textContent = 'Unable to copy. Please select and copy manually.';
          s.className = 'status warn';
        }
      }
    });
    syncPreview();
  });
</script>

<!-- Main app logic -->
<script defer src="{{ '/order-helper/app.js' | relative_url }}?v=20250905"></script>
