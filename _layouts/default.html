<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ page.title }} | OraDigit</title>
  <meta name="description" content="{{ page.description | default: 'OraDigit â€“ Anchored in Trust. Driven by Data.' }}">
  <link rel="icon" href="{{ '/assets/logo.png' | relative_url }}" type="image/png">
  <link rel="stylesheet" href="{{ '/assets/css/style.css?v=2' | relative_url }}">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
</head>
<body>
  {% include navigation.html %}
  <main class="page-content">
    {{ content }}
  </main>
  {% include footer.html %}
 <!-- Back to Top Button -->
<button id="backToTop" title="Back to Top">â†‘</button>

<script>
  // Show/hide back to top button
  const backToTop = document.getElementById("backToTop");

  window.onscroll = function () {
    if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) {
      backToTop.style.display = "block";
    } else {
      backToTop.style.display = "none";
    }
  };

  backToTop.onclick = function () {
    window.scrollTo({ top: 0, behavior: "smooth" });
  };
</script>
  <!-- â€¦your existing page contentâ€¦ -->
 
  <!-- Chatbot Widget -->
  <div id="chatbot-container">
    <button id="chatbot-toggle" aria-label="Chat with us!">ðŸ’¬</button>
    <div id="chatbot-box" class="hidden">
      <div id="chatbot-header">OraDigit Assistant</div>
      <div id="chatbot-messages"></div>
      <input id="chatbot-input" placeholder="Ask me anythingâ€¦" autocomplete="off" />
    </div>
  </div>

  <script>
    (function() {
      const CHAT_URL = "https://us-central1-oradigit-ce343.cloudfunctions.net/chatGPTQuery";

      const toggleBtn = document.getElementById('chatbot-toggle');
      const box       = document.getElementById('chatbot-box');
      const input     = document.getElementById('chatbot-input');
      const messages  = document.getElementById('chatbot-messages');

      toggleBtn.addEventListener('click', () => {
        box.classList.toggle('hidden');
      });

      input.addEventListener('keydown', async (e) => {
        if (e.key !== 'Enter') return;
        const prompt = input.value.trim();
        if (!prompt) return;

        messages.innerHTML += `<div><strong>You:</strong> ${prompt}</div>`;
        input.value = '';
        messages.scrollTop = messages.scrollHeight;

        try {
          const res = await fetch(CHAT_URL, {
            method: 'POST',
            mode: 'cors',                        // explicitly request CORS
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ prompt }),
          });

          if (!res.ok) {
            const text = await res.text();
            throw new Error(`HTTP ${res.status}: ${text}`);
          }

          const { reply } = await res.json();
          messages.innerHTML += `<div><strong>Assistant:</strong> ${reply}</div>`;
          messages.scrollTop = messages.scrollHeight;
        } catch (err) {
          console.error(err);
          messages.innerHTML += `<div style="color:red;"><strong>Error:</strong> ${err.message}</div>`;
          messages.scrollTop = messages.scrollHeight;
        }
      });
    })();
  </script>
</body>
</html>
